<!DOCTYPE html>
<html>
<head>
  <title>Shopping Cart</title>
  <style>
    body { font-family: Arial; }
    .invalid { border: 2px solid red; }
  </style>
</head>

<body>
<div align="center">

<h2>Shopping Cart</h2>
<div id="cart"></div>

<h3>Add Product</h3>
<input id="pname" placeholder="Product name">
<input id="pprice" type="number" placeholder="Price">
<input id="pqty" type="number" placeholder="Quantity">
<input id="pcat" placeholder="Category">
<button onclick="addProduct()">Add</button>

<h3>Coupon</h3>
<input id="coupon" placeholder="Enter coupon code">
<button onclick="applyCoupon()">Apply Coupon</button>

<script>
let products = [
  {name:"Book", price:100, qty:2, category:"Education"},
  {name:"Laptop", price:1000, qty:1, category:"Electronics"}
];
let couponDiscount = 0;

function renderCart(){
  const div=document.getElementById("cart");
  div.innerHTML="";
  products.forEach((p,i)=>{
    div.innerHTML+=`${p.name} (${p.category}) - $${p.price} x 
      <input type="number" value="${p.qty}" onchange="updateQty(${i},this.value)">
      <button onclick="removeProduct(${i})">Remove</button><br>`;
  });
  div.innerHTML+=`<br><b>Total: $${calculateTotal()}</b>`;
}

function addProduct(){
  const name=document.getElementById("pname").value;
  const price=parseFloat(document.getElementById("pprice").value);
  const qty=parseInt(document.getElementById("pqty").value);
  const cat=document.getElementById("pcat").value;
  if(!name||!price||!qty||!cat) return alert("Fill all fields!");
  products.push({name,price,qty,category:cat});
  renderCart();
}

function removeProduct(i){ products.splice(i,1); renderCart(); }
function updateQty(i,val){ products[i].qty=parseInt(val); renderCart(); }

function calculateTotal(){
  let total=0;
  const hour=new Date().getHours();
  products.forEach(p=>{
    let subtotal=p.price*p.qty;
    if(p.qty>=3) subtotal*=0.9;  
    if(p.category==="Education") subtotal*=0.95; 
    if(hour>=18 && hour<=20) subtotal*=0.95;  
    total+=subtotal;
  });
  return (total*(1-couponDiscount)).toFixed(2);
}

function applyCoupon(){
  const code=document.getElementById("coupon").value.trim().toUpperCase();
  if(code.startsWith("SAVE") && code.endsWith("10")) couponDiscount=0.1;
  else couponDiscount=0;
  renderCart();
}

renderCart();
</script>

</body>
</div>
</html>